# RPC Proxy Server

Прокси-сервер для обработки запросов к различным RPC-узлам блокчейн-сетей. Прокси выбирает случайный рабочий RPC из списка доступных для запрашиваемой сети.

## Функции

- Поддержка нескольких блокчейн-сетей через параметр `chain_id`
- Случайный выбор RPC из доступных для каждой сети
- Проверка работоспособности RPC перед возвратом
- Автоматическое переключение на другой RPC в случае отказа
- Периодическая проверка всех RPC для поддержания актуального статуса

## Настройка для Railway.app

### Вариант 1: Деплой через GitHub

1. Форкните этот репозиторий на GitHub
2. На [Railway](https://railway.app/), войдите в свой аккаунт
3. Нажмите "New Project" > "Deploy from GitHub repo"
4. Выберите форкнутый репозиторий
5. Настройте переменные окружения (необязательно):
   - `PORT`: порт для прослушивания (Railway устанавливает его автоматически)
   - `RPC_LIST`: JSON-строка с вашим списком RPC-узлов (пример ниже)
   - `RETRY_TIMEOUT`: время (мс) до повторной проверки неработающего RPC (по умолчанию 300000)
   - `CHECK_INTERVAL`: интервал (мс) проверки всех RPC (по умолчанию 900000)
   - `REQUEST_TIMEOUT`: таймаут (мс) для проверки RPC (по умолчанию 3000)

Пример значения переменной `RPC_LIST`:
```json
{
  "1": [
    "https://eth-mainnet.alchemyapi.io/v2/your-api-key",
    "https://mainnet.infura.io/v3/your-api-key"
  ],
  "56": [
    "https://bsc-dataseed.binance.org",
    "https://bsc-dataseed1.defibit.io"
  ]
}
```

### Вариант 2: Деплой с Railway CLI

1. Установите Railway CLI: `npm i -g @railway/cli`
2. Залогиньтесь: `railway login`
3. Создайте новый проект: `railway init`
4. Разверните проект: `railway up`
5. Настройте переменные как указано выше: `railway variables set RPC_LIST='{"1":["url1","url2"]}'`

## Локальное использование

1. Клонируйте репозиторий
2. Установите зависимости: `npm install`
3. Создайте файл `rpcs.json` или настройте переменную окружения `RPC_LIST`
4. Запустите сервер: `npm start`

## Использование API

```
GET /rpc?chain_id=1
```

Возвращает работающий RPC для указанной сети.

Пример ответа:
```json
{
  "rpc": "https://eth-mainnet.alchemyapi.io/v2/your-api-key"
}
```

## Проверка статуса сервиса

```
GET /health
```

Возвращает 200 OK, если сервис работает.